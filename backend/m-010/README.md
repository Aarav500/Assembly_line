Explain-Change Summaries for AI-Generated Commits (1-sentence)

Overview
- This repository provides a small Flask service and a Git commit-msg hook that appends a one-sentence "Explain-Change" rationale to every AI-generated commit.

How it works
- You mark commits as AI-generated by adding a trailer line to the commit message: "AI-Generated: true".
- The commit-msg hook inspects staged changes and either:
  - Calls the local summarizer (default), or
  - Calls the Flask service at $EXPLAIN_SERVICE_URL/explain-change if configured.
- It then appends a single trailer line like: "Explain-Change: <one-sentence rationale>".

Install
1) Install dependencies
   - python -m venv .venv && . .venv/bin/activate
   - pip install -r requirements.txt

2) Install the commit-msg hook
   - cp git_hooks/commit_msg.py .git/hooks/commit-msg
   - chmod +x .git/hooks/commit-msg

3) Optional: Run the Flask service
   - FLASK_ENV=production python app.py
   - Service runs on http://0.0.0.0:8000

Marking AI-generated commits
- Ensure your commit message includes a trailer line:
  AI-Generated: true

Configuration (env vars)
- EXPLAIN_SERVICE_URL: If set, the hook will call this service for the explanation.
- EXPLAIN_SERVICE_TIMEOUT: HTTP timeout (seconds), default 5.
- EXPLAIN_TRAILER_LABEL: Trailer key used for explanation, default "Explain-Change".
- AI_TRAILER_LABEL: Trailer key used to detect AI commits, default "AI-Generated".

API
- POST /explain-change
  Request JSON: {"message": string, "files": [{"path": str, "status": str, "additions": int, "deletions": int}], "diff": string?}
  Response JSON: {"explanation": string}

Notes
- The local summarizer is heuristic and does not call external LLMs.
- If an "Explain-Change" trailer already exists, the hook will not add another.
- Renames are detected from git diff --cached --name-status lines starting with R.

